import { NodeTemplate } from '@/types/journey';

export const triggerTemplates: NodeTemplate[] = [
  {
    type: 'occurrence-of-event',
    category: 'trigger',
    label: 'Occurrence of Event',
    description: 'Start journey when an event occurs',
    icon: 'Zap',
    defaultConfig: { eventName: '', conditions: [] },
  },
  {
    type: 'enter-segment',
    category: 'trigger',
    label: 'Enter Segment',
    description: 'Start when user enters a segment',
    icon: 'LogIn',
    defaultConfig: { segmentId: '' },
  },
  {
    type: 'exit-segment',
    category: 'trigger',
    label: 'Exit Segment',
    description: 'Start when user exits a segment',
    icon: 'LogOut',
    defaultConfig: { segmentId: '' },
  },
  {
    type: 'is-in-segment',
    category: 'trigger',
    label: 'Is In Segment',
    description: 'Start for users in a segment',
    icon: 'Users',
    defaultConfig: { segmentId: '' },
  },
  {
    type: 'change-user-attribute',
    category: 'trigger',
    label: 'Change in User Attribute',
    description: 'Start when attribute changes',
    icon: 'RefreshCw',
    defaultConfig: { attribute: '', from: '', to: '' },
  },
  {
    type: 'specific-users',
    category: 'trigger',
    label: 'For Specific Users',
    description: 'Target specific users via CSV',
    icon: 'FileSpreadsheet',
    defaultConfig: { csvFile: null },
  },
  {
    type: 'enter-geofence',
    category: 'trigger',
    label: 'Enter Geo-fence',
    description: 'Start when user enters location',
    icon: 'MapPin',
    defaultConfig: { location: null, radius: 100 },
  },
  {
    type: 'exit-geofence',
    category: 'trigger',
    label: 'Exit Geo-fence',
    description: 'Start when user exits location',
    icon: 'MapPinOff',
    defaultConfig: { location: null, radius: 100 },
  },
];

export const actionTemplates: NodeTemplate[] = [
  {
    type: 'send-email',
    category: 'action',
    label: 'Send Email',
    description: 'Send an email message',
    icon: 'Mail',
    defaultConfig: { templateId: '', subject: '', content: '' },
  },
  {
    type: 'send-sms',
    category: 'action',
    label: 'Send SMS',
    description: 'Send an SMS message',
    icon: 'MessageSquare',
    defaultConfig: { templateId: '', content: '' },
  },
  {
    type: 'send-rcs',
    category: 'action',
    label: 'Send RCS',
    description: 'Send an RCS message',
    icon: 'MessageCircle',
    defaultConfig: { templateId: '', content: '' },
  },
  {
    type: 'send-push',
    category: 'action',
    label: 'Send Push',
    description: 'Send a push notification',
    icon: 'Bell',
    defaultConfig: { title: '', body: '', icon: '' },
  },
  {
    type: 'send-whatsapp',
    category: 'action',
    label: 'Send WhatsApp',
    description: 'Send a WhatsApp message',
    icon: 'MessageCircle',
    defaultConfig: { templateId: '', content: '' },
  },
  {
    type: 'send-web-push',
    category: 'action',
    label: 'Send Web Push',
    description: 'Send a web push notification',
    icon: 'Globe',
    defaultConfig: { title: '', body: '', url: '' },
  },
  {
    type: 'show-in-app',
    category: 'action',
    label: 'Show In-App',
    description: 'Show in-app notification',
    icon: 'Smartphone',
    defaultConfig: { templateId: '', type: 'modal' },
  },
  {
    type: 'show-onsite',
    category: 'action',
    label: 'Show On-site Notification',
    description: 'Show on-site notification',
    icon: 'MonitorSmartphone',
    defaultConfig: { templateId: '', position: 'bottom-right' },
  },
  {
    type: 'show-app-inline',
    category: 'action',
    label: 'Show App In-line Content',
    description: 'Show inline content in app',
    icon: 'LayoutTemplate',
    defaultConfig: { templateId: '', placement: '' },
  },
  {
    type: 'show-web-inline',
    category: 'action',
    label: 'Show Web In-line Content',
    description: 'Show inline content on web',
    icon: 'Layout',
    defaultConfig: { templateId: '', selector: '' },
  },
  {
    type: 'call-api',
    category: 'action',
    label: 'Call an API',
    description: 'Make an API request (webhook)',
    icon: 'Webhook',
    defaultConfig: { url: '', method: 'POST', headers: {}, body: {} },
  },
  {
    type: 'set-user-attribute',
    category: 'action',
    label: 'Set User Attribute',
    description: 'Update user attribute',
    icon: 'UserCog',
    defaultConfig: { attribute: '', value: '' },
  },
];

export const conditionTemplates: NodeTemplate[] = [
  {
    type: 'is-in-segment',
    category: 'condition',
    label: 'Is In Segment',
    description: 'Check if user is in segment',
    icon: 'Users',
    defaultConfig: { segmentId: '' },
  },
  {
    type: 'is-in-list',
    category: 'condition',
    label: 'Is In List',
    description: 'Check if user is in list',
    icon: 'List',
    defaultConfig: { listId: '' },
  },
  {
    type: 'has-done-event',
    category: 'condition',
    label: 'Has Done Event',
    description: 'Check if user did event',
    icon: 'CheckCircle',
    defaultConfig: { eventName: '', timeframe: '7d' },
  },
  {
    type: 'check-user-attribute',
    category: 'condition',
    label: 'Check User Attribute',
    description: 'Evaluate user attribute',
    icon: 'UserCheck',
    defaultConfig: { attribute: '', operator: 'equals', value: '' },
  },
  {
    type: 'is-reachable',
    category: 'condition',
    label: 'Is User Reachable?',
    description: 'Check channel reachability',
    icon: 'Radio',
    defaultConfig: { channels: ['email'] },
  },
  {
    type: 'check-best-channel',
    category: 'condition',
    label: 'Check Best Channel',
    description: 'Find optimal channel',
    icon: 'Shuffle',
    defaultConfig: { channels: ['email', 'sms', 'push'] },
  },
];

export const flowTemplates: NodeTemplate[] = [
  {
    type: 'wait-time',
    category: 'flow',
    label: 'Wait for Some Time',
    description: 'Wait for a specific duration',
    icon: 'Clock',
    defaultConfig: { duration: 1, unit: 'hours' },
  },
  {
    type: 'wait-time-slot',
    category: 'flow',
    label: 'Wait for Time Slots',
    description: 'Wait for specific time slots',
    icon: 'Calendar',
    defaultConfig: { slots: [] },
  },
  {
    type: 'wait-event',
    category: 'flow',
    label: 'Wait for Event',
    description: 'Wait until event occurs',
    icon: 'Hourglass',
    defaultConfig: { eventName: '', timeout: '7d' },
  },
  {
    type: 'wait-date',
    category: 'flow',
    label: 'Wait for Date',
    description: 'Wait until specific date',
    icon: 'CalendarDays',
    defaultConfig: { date: null, attribute: '' },
  },
  {
    type: 'split',
    category: 'flow',
    label: 'Split',
    description: 'A/B test with split paths',
    icon: 'GitBranch',
    defaultConfig: { branches: [{ name: 'A', percentage: 50 }, { name: 'B', percentage: 50 }] },
  },
  {
    type: 'end-journey',
    category: 'flow',
    label: 'End Journey',
    description: 'End the journey here',
    icon: 'XCircle',
    defaultConfig: {},
  },
];

export const allTemplates = [
  ...triggerTemplates,
  ...actionTemplates,
  ...conditionTemplates,
  ...flowTemplates,
];

export const getTemplateByType = (type: string): NodeTemplate | undefined => {
  return allTemplates.find((t) => t.type === type);
};

export const categoryConfig = {
  trigger: {
    label: 'Triggers',
    description: 'Events that start the journey',
    color: 'node-trigger',
    bgColor: 'node-trigger-bg',
  },
  action: {
    label: 'Actions',
    description: 'Messages and updates to perform',
    color: 'node-action',
    bgColor: 'node-action-bg',
  },
  condition: {
    label: 'Conditions',
    description: 'Rules to evaluate',
    color: 'node-condition',
    bgColor: 'node-condition-bg',
  },
  flow: {
    label: 'Flow Control',
    description: 'Control journey flow',
    color: 'node-flow',
    bgColor: 'node-flow-bg',
  },
};
